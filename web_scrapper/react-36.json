{"id": 36, "url": "https://react.dev/reference/rules/rules-of-hooks", "title": "Rules of Hooks", "content": "'Rules of Hooks ‚Äì React', 'Stream React Conf on May 15-16.', 'Learn more.', 'React', 'Search', '‚åò', 'Ctrl', 'K', 'Learn', 'Reference', 'Community', 'Blog', 'react@18.2.0', 'Overview', ' ', 'Hooks', ' ', 'use', ' ', ' - This feature is available in the latest Canary', 'useCallback', ' ', 'useContext', ' ', 'useDebugValue', ' ', 'useDeferredValue', ' ', 'useEffect', ' ', 'useId', ' ', 'useImperativeHandle', ' ', 'useInsertionEffect', ' ', 'useLayoutEffect', ' ', 'useMemo', ' ', 'useOptimistic', ' ', ' - This feature is available in the latest Canary', 'useReducer', ' ', 'useRef', ' ', 'useState', ' ', 'useSyncExternalStore', ' ', 'useTransition', ' ', 'Components', ' ', '<Fragment> (<>)', ' ', '<Profiler>', ' ', '<StrictMode>', ' ', '<Suspense>', ' ', 'APIs', ' ', 'cache', ' ', ' - This feature is available in the latest Canary', 'createContext', ' ', 'forwardRef', ' ', 'lazy', ' ', 'memo', ' ', 'startTransition', ' ', 'experimental_taintObjectReference', ' ', ' - This feature is available in the latest Canary', 'experimental_taintUniqueValue', ' ', ' - This feature is available in the latest Canary', 'Directives', ' ', ' - This feature is available in the latest Canary', \"'use client'\", ' ', ' - This feature is available in the latest Canary', \"'use server'\", ' ', ' - This feature is available in the latest Canary', 'react-dom@18.2.0', 'Hooks', ' ', 'useFormState', ' ', ' - This feature is available in the latest Canary', 'useFormStatus', ' ', ' - This feature is available in the latest Canary', 'Components', ' ', 'Common (e.g. <div>)', ' ', '<form>', ' ', ' - This feature is available in the latest Canary', '<input>', ' ', '<option>', ' ', '<progress>', ' ', '<select>', ' ', '<textarea>', ' ', '<link>', ' ', ' - This feature is available in the latest Canary', '<meta>', ' ', ' - This feature is available in the latest Canary', '<script>', ' ', ' - This feature is available in the latest Canary', '<style>', ' ', ' - This feature is available in the latest Canary', '<title>', ' ', ' - This feature is available in the latest Canary', 'APIs', ' ', 'createPortal', ' ', 'flushSync', ' ', 'findDOMNode', ' ', 'hydrate', ' ', 'preconnect', ' ', ' - This feature is available in the latest Canary', 'prefetchDNS', ' ', ' - This feature is available in the latest Canary', 'preinit', ' ', ' - This feature is available in the latest Canary', 'preinitModule', ' ', ' - This feature is available in the latest Canary', 'preload', ' ', ' - This feature is available in the latest Canary', 'preloadModule', ' ', ' - This feature is available in the latest Canary', 'render', ' ', 'unmountComponentAtNode', ' ', 'Client APIs', ' ', 'createRoot', ' ', 'hydrateRoot', ' ', 'Server APIs', ' ', 'renderToNodeStream', ' ', 'renderToPipeableStream', ' ', 'renderToReadableStream', ' ', 'renderToStaticMarkup', ' ', 'renderToStaticNodeStream', ' ', 'renderToString', ' ', 'Rules of React', 'Overview', ' ', 'Components and Hooks must be pure', ' ', 'React calls Components and Hooks', ' ', 'Rules of Hooks', ' ', 'Legacy APIs', 'Legacy React APIs', ' ', 'Children', ' ', 'cloneElement', ' ', 'Component', ' ', 'createElement', ' ', 'createFactory', ' ', 'createRef', ' ', 'isValidElement', ' ', 'PureComponent', ' ', 'Is this page useful?', 'API Reference', 'Rules of Hooks', 'Hooks are defined using JavaScript functions, but they represent a special type of reusable UI logic with restrictions on where they can be called.', '\\n', 'Only call Hooks at the top level ', 'Only call Hooks from React functions ', '\\n', '\\n', 'Only call Hooks at the top level ', '\\n', 'Functions whose names start with ', 'use', ' are called ', 'Hooks', ' in React.', '\\n', 'Don‚Äôt call Hooks inside loops, conditions, nested functions, or ', 'try', '/', 'catch', '/', 'finally', ' blocks.', ' Instead, always use Hooks at the top level of your React function, before any early returns. You can only call Hooks while React is rendering a function component:', '\\n', '\\n', '‚úÖ Call them at the top level in the body of a ', 'function component', '.', '\\n', '‚úÖ Call them at the top level in the body of a ', 'custom Hook', '.', '\\n', '\\n', 'function', ' ', 'Counter', '(', ')', ' ', '{', '  ', '// ‚úÖ Good: top-level in a function component', '  ', 'const', ' ', '[', 'count', ',', ' ', 'setCount', ']', ' = ', 'useState', '(', '0', ')', ';', '  ', '// ...', '}', 'function', ' ', 'useWindowWidth', '(', ')', ' ', '{', '  ', '// ‚úÖ Good: top-level in a custom Hook', '  ', 'const', ' ', '[', 'width', ',', ' ', 'setWidth', ']', ' = ', 'useState', '(', 'window', '.', 'innerWidth', ')', ';', '  ', '// ...', '}', '\\n', 'It‚Äôs ', 'not', ' supported to call Hooks (functions starting with ', 'use', ') in any other cases, for example:', '\\n', '\\n', 'üî¥ Do not call Hooks inside conditions or loops.', '\\n', 'üî¥ Do not call Hooks after a conditional ', 'return', ' statement.', '\\n', 'üî¥ Do not call Hooks in event handlers.', '\\n', 'üî¥ Do not call Hooks in class components.', '\\n', 'üî¥ Do not call Hooks inside functions passed to ', 'useMemo', ', ', 'useReducer', ', or ', 'useEffect', '.', '\\n', 'üî¥ Do not call Hooks inside ', 'try', '/', 'catch', '/', 'finally', ' blocks.', '\\n', '\\n', 'If you break these rules, you might see this error.', '\\n', 'function', ' ', 'Bad', '(', '{', ' ', 'cond', ' ', '}', ')', ' ', '{', '  ', 'if', ' ', '(', 'cond', ')', ' ', '{', '    ', '// üî¥ Bad: inside a condition (to fix, move it outside!)', '    ', 'const', ' ', 'theme', ' = ', 'useContext', '(', 'ThemeContext', ')', ';', '  ', '}', '  ', '// ...', '}', 'function', ' ', 'Bad', '(', ')', ' ', '{', '  ', 'for', ' ', '(', 'let', ' ', 'i', ' = ', '0', ';', ' ', 'i', ' < ', '10', ';', ' ', 'i', '++', ')', ' ', '{', '    ', '// üî¥ Bad: inside a loop (to fix, move it outside!)', '    ', 'const', ' ', 'theme', ' = ', 'useContext', '(', 'ThemeContext', ')', ';', '  ', '}', '  ', '// ...', '}', 'function', ' ', 'Bad', '(', '{', ' ', 'cond', ' ', '}', ')', ' ', '{', '  ', 'if', ' ', '(', 'cond', ')', ' ', '{', '    ', 'return', ';', '  ', '}', '  ', '// üî¥ Bad: after a conditional return (to fix, move it before the return!)', '  ', 'const', ' ', 'theme', ' = ', 'useContext', '(', 'ThemeContext', ')', ';', '  ', '// ...', '}', 'function', ' ', 'Bad', '(', ')', ' ', '{', '  ', 'function', ' ', 'handleClick', '(', ')', ' ', '{', '    ', '// üî¥ Bad: inside an event handler (to fix, move it outside!)', '    ', 'const', ' ', 'theme', ' = ', 'useContext', '(', 'ThemeContext', ')', ';', '  ', '}', '  ', '// ...', '}', 'function', ' ', 'Bad', '(', ')', ' ', '{', '  ', 'const', ' ', 'style', ' = ', 'useMemo', '(', '(', ')', ' ', '=>', ' ', '{', '    ', '// üî¥ Bad: inside useMemo (to fix, move it outside!)', '    ', 'const', ' ', 'theme', ' = ', 'useContext', '(', 'ThemeContext', ')', ';', '    ', 'return', ' ', 'createStyle', '(', 'theme', ')', ';', '  ', '}', ')', ';', '  ', '// ...', '}', 'class', ' Bad ', 'extends', ' ', 'React', '.', 'Component', ' ', '{', '  ', 'render', '(', ')', ' ', '{', '    ', '// üî¥ Bad: inside a class component (to fix, write a function component instead of a class!)', '    ', 'useEffect', '(', '(', ')', ' ', '=>', ' ', '{', '}', ')', '    ', '// ...', '  ', '}', '}', 'function', ' ', 'Bad', '(', ')', ' ', '{', '  ', 'try', ' ', '{', '    ', '// üî¥ Bad: inside try/catch/finally block (to fix, move it outside!)', '    ', 'const', ' ', '[', 'x', ',', ' ', 'setX', ']', ' = ', 'useState', '(', '0', ')', ';', '  ', '}', ' ', 'catch', ' ', '{', '    ', 'const', ' ', '[', 'x', ',', ' ', 'setX', ']', ' = ', 'useState', '(', '1', ')', ';', '  ', '}', '}', '\\n', 'You can use the ', 'eslint-plugin-react-hooks', ' plugin', ' to catch these mistakes.', '\\n', 'Note', 'Custom Hooks', ' ', 'may', ' call other Hooks (that‚Äôs their whole purpose). This works because custom Hooks are also supposed to only be called while a function component is rendering.', '\\n', '\\n', 'Only call Hooks from React functions ', '\\n', 'Don‚Äôt call Hooks from regular JavaScript functions. Instead, you can:', '\\n', '‚úÖ Call Hooks from React function components.\\n‚úÖ Call Hooks from ', 'custom Hooks', '.', '\\n', 'By following this rule, you ensure that all stateful logic in a component is clearly visible from its source code.', '\\n', 'function', ' ', 'FriendList', '(', ')', ' ', '{', '  ', 'const', ' ', '[', 'onlineStatus', ',', ' ', 'setOnlineStatus', ']', ' = ', 'useOnlineStatus', '(', ')', ';', ' ', '// ‚úÖ', '}', 'function', ' ', 'setOnlineStatus', '(', ')', ' ', '{', ' ', '// ‚ùå Not a component or custom Hook!', '  ', 'const', ' ', '[', 'onlineStatus', ',', ' ', 'setOnlineStatus', ']', ' = ', 'useOnlineStatus', '(', ')', ';', '}', 'Previous', 'React calls Components and Hooks', 'How do you like these docs?', 'Take our survey!', '¬©', '2024', 'Learn React', 'Quick Start', 'Installation', 'Describing the UI', 'Adding Interactivity', 'Managing State', 'Escape Hatches', 'API Reference', 'React APIs', 'React DOM APIs', 'Community', 'Code of Conduct', 'Meet the Team', 'Docs Contributors', 'Acknowledgements', 'More', 'Blog', 'React Native', 'Privacy', 'Terms', 'On this page', 'Overview', 'Only call Hooks at the top level ', 'Only call Hooks from React functions ', "}