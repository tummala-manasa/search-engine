{"id": 17, "url": "https://react.dev/learn/scaling-up-with-reducer-and-context", "title": "Scaling Up with Reducer and Context", "content": "'Scaling Up with Reducer and Context – React', 'Stream React Conf on May 15-16.', 'Learn more.', 'React', 'Search', '⌘', 'Ctrl', 'K', 'Learn', 'Reference', 'Community', 'Blog', 'GET STARTED', 'Quick Start', ' ', 'Tutorial: Tic-Tac-Toe', ' ', 'Thinking in React', ' ', 'Installation', ' ', 'Start a New React Project', ' ', 'Add React to an Existing Project', ' ', 'Editor Setup', ' ', 'Using TypeScript', ' ', 'React Developer Tools', ' ', 'LEARN REACT', 'Describing the UI', ' ', 'Your First Component', ' ', 'Importing and Exporting Components', ' ', 'Writing Markup with JSX', ' ', 'JavaScript in JSX with Curly Braces', ' ', 'Passing Props to a Component', ' ', 'Conditional Rendering', ' ', 'Rendering Lists', ' ', 'Keeping Components Pure', ' ', 'Your UI as a Tree', ' ', 'Adding Interactivity', ' ', 'Responding to Events', ' ', \"State: A Component's Memory\", ' ', 'Render and Commit', ' ', 'State as a Snapshot', ' ', 'Queueing a Series of State Updates', ' ', 'Updating Objects in State', ' ', 'Updating Arrays in State', ' ', 'Managing State', ' ', 'Reacting to Input with State', ' ', 'Choosing the State Structure', ' ', 'Sharing State Between Components', ' ', 'Preserving and Resetting State', ' ', 'Extracting State Logic into a Reducer', ' ', 'Passing Data Deeply with Context', ' ', 'Scaling Up with Reducer and Context', ' ', 'Escape Hatches', ' ', 'Referencing Values with Refs', ' ', 'Manipulating the DOM with Refs', ' ', 'Synchronizing with Effects', ' ', 'You Might Not Need an Effect', ' ', 'Lifecycle of Reactive Effects', ' ', 'Separating Events from Effects', ' ', 'Removing Effect Dependencies', ' ', 'Reusing Logic with Custom Hooks', ' ', 'Is this page useful?', 'Learn React', 'Managing State', 'Scaling Up with Reducer and Context', 'Reducers let you consolidate a component’s state update logic. Context lets you pass information deep down to other components. You can combine reducers and context together to manage state of a complex screen.', '\\n', 'You will learn', '\\n', 'How to combine a reducer with context', '\\n', 'How to avoid passing state and dispatch through props', '\\n', 'How to keep context and state logic in a separate file', '\\n', '\\n', 'Combining a reducer with context ', '\\n', 'In this example from ', 'the introduction to reducers', ', the state is managed by a reducer. The reducer function contains all of the state update logic and is declared at the bottom of this file:', '\\n', 'App.js', 'AddTask.js', 'TaskList.js', 'App.js', ' Reset', 'Fork', 'import', ' ', '{', ' ', 'useReducer', ' ', '}', ' ', 'from', ' ', \"'react'\", ';', '\\n', 'import', ' ', 'AddTask', ' ', 'from', ' ', \"'./AddTask.js'\", ';', '\\n', 'import', ' ', 'TaskList', ' ', 'from', ' ', \"'./TaskList.js'\", ';', '\\n\\n', 'export', ' ', 'default', ' ', 'function', ' ', 'TaskApp', '(', ')', ' ', '{', '\\n  ', 'const', ' ', '[', 'tasks', ',', ' ', 'dispatch', ']', ' = ', 'useReducer', '(', '\\n    ', 'tasksReducer', ',', '\\n    ', 'initialTasks', '\\n  ', ')', ';', '\\n\\n  ', 'function', ' ', 'handleAddTask', '(', 'text', ')', ' ', '{', '\\n    ', 'dispatch', '(', '{', '\\n      ', 'type', ':', ' ', \"'added'\", ',', '\\n      ', 'id', ':', ' ', 'nextId', '++', ',', '\\n      ', 'text', ':', ' ', 'text', ',', '\\n    ', '}', ')', ';', '\\n  ', '}', '\\n\\n  ', 'function', ' ', 'handleChangeTask', '(', 'task', ')', ' ', '{', '\\n    ', 'dispatch', '(', '{', '\\n      ', 'type', ':', ' ', \"'changed'\", ',', '\\n      ', 'task', ':', ' ', 'task', '\\n    ', '}', ')', ';', '\\n  ', '}', '\\n\\n  ', 'function', ' ', 'handleDeleteTask', '(', 'taskId', ')', ' ', '{', '\\n    ', 'dispatch', '(', '{', '\\n      ', 'type', ':', ' ', \"'deleted'\", ',', '\\n      ', 'id', ':', ' ', 'taskId', '\\n    ', '}', ')', ';', '\\n  ', '}', '\\n\\n  ', 'return', ' ', '(', '\\n    ', '<', '>', '\\n      ', '<', 'h1', '>', 'Day off in Kyoto', '</', 'h1', '>', '\\n      ', '<', 'AddTask', '\\n        ', 'onAddTask', '=', '{', 'handleAddTask', '}', '\\n      ', '/>', '\\n      ', '<', 'TaskList', '\\n        ', 'tasks', '=', '{', 'tasks', '}', '\\n        ', 'onChangeTask', '=', '{', 'handleChangeTask', '}', '\\n        ', 'onDeleteTask', '=', '{', 'handleDeleteTask', '}', '\\n      ', '/>', '\\n    ', '</', '>', '\\n  ', ')', ';', '\\n', '}', '\\n\\n', 'function', ' ', 'tasksReducer', '(', 'tasks', ',', ' ', 'action', ')', ' ', '{', '\\n  ', 'switch', ' ', '(', 'action', '.', 'type', ')', ' ', '{', '\\n    ', 'case', ' ', \"'added'\", ':', ' ', '{', '\\n      ', 'return', ' ', '[', '...', 'tasks', ',', ' ', '{', '\\n        ', 'id', ':', ' ', 'action', '.', 'id', ',', '\\n        ', 'text', ':', ' ', 'action', '.', 'text', ',', '\\n        ', 'done', ':', ' ', 'false', '\\n      ', '}', ']', ';', '\\n    ', '}', '\\n    ', 'case', ' ', \"'changed'\", ':', ' ', '{', '\\n      ', 'return', ' ', 'tasks', '.', 'map', '(', 't', ' ', '=>', ' ', '{', '\\n        ', 'if', ' ', '(', 't', '.', 'id', ' === ', 'action', '.', 'task', '.', 'id', ')', ' ', '{', '\\n          ', 'return', ' ', 'action', '.', 'task', ';', '\\n        ', '}', ' ', 'else', ' ', '{', '\\n          ', 'return', ' ', 't', ';', '\\n        ', '}', '\\n      ', '}', ')', ';', '\\n    ', '}', '\\n    ', 'case', ' ', \"'deleted'\", ':', ' ', '{', '\\n      ', 'return', ' ', 'tasks', '.', 'filter', '(', 't', ' ', '=>', ' ', 't', '.', 'id', ' !== ', 'action', '.', 'id', ')', ';', '\\n    ', '}', '\\n    ', 'default', ':', ' ', '{', '\\n      ', 'throw', ' ', 'Error', '(', \"'Unknown action: '\", ' + ', 'action', '.', 'type', ')', ';', '\\n    ', '}', '\\n  ', '}', '\\n', '}', '\\n\\n', 'let', ' ', 'nextId', ' = ', '3', ';', '\\n', 'const', ' ', 'initialTasks', ' = ', '[', '\\n  ', '{', ' ', 'id', ':', ' ', '0', ',', ' ', 'text', ':', ' ', \"'Philosopher’s Path'\", ',', ' ', 'done', ':', ' ', 'true', ' ', '}', ',', '\\n  ', '{', ' ', 'id', ':', ' ', '1', ',', ' ', 'text', ':', ' ', \"'Visit the temple'\", ',', ' ', 'done', ':', ' ', 'false', ' ', '}', ',', '\\n  ', '{', ' ', 'id', ':', ' ', '2', ',', ' ', 'text', ':', ' ', \"'Drink matcha'\", ',', ' ', 'done', ':', ' ', 'false', ' ', '}', '\\n', ']', ';', '\\n\\n', 'Show more', '\\n', 'A reducer helps keep the event handlers short and concise. However, as your app grows, you might run into another difficulty. ', 'Currently, the ', 'tasks', ' state and the ', 'dispatch', ' function are only available in the top-level ', 'TaskApp', ' component.', ' To let other components read the list of tasks or change it, you have to explicitly ', 'pass down', ' the current state and the event handlers that change it as props.', '\\n', 'For example, ', 'TaskApp', ' passes a list of tasks and the event handlers to ', 'TaskList', ':', '\\n', '<', 'TaskList', '  ', 'tasks', '=', '{', 'tasks', '}', '  ', 'onChangeTask', '=', '{', 'handleChangeTask', '}', '  ', 'onDeleteTask', '=', '{', 'handleDeleteTask', '}', '/>', '\\n', 'And ', 'TaskList', ' passes the event handlers to ', 'Task', ':', '\\n', '<', 'Task', '  ', 'task', '=', '{', 'task', '}', '  ', 'onChange', '=', '{', 'onChangeTask', '}', '  ', 'onDelete', '=', '{', 'onDeleteTask', '}', '/>', '\\n', 'In a small example like this, this works well, but if you have tens or hundreds of components in the middle, passing down all state and functions can be quite frustrating!', '\\n', 'This is why, as an alternative to passing them through props, you might want to put both the ', 'tasks', ' state and the ', 'dispatch', ' function ', 'into context.', ' ', 'This way, any component below ', 'TaskApp', ' in the tree can read the tasks and dispatch actions without the repetitive “prop drilling”.', '\\n', 'Here is how you can combine a reducer with context:', '\\n', '\\n', 'Create', ' the context.', '\\n', 'Put', ' state and dispatch into context.', '\\n', 'Use', ' context anywhere in the tree.', '\\n', '\\n', 'Step 1: Create the context ', '\\n', 'The ', 'useReducer', ' Hook returns the current ', 'tasks', ' and the ', 'dispatch', ' function that lets you update them:', '\\n', 'const', ' ', '[', 'tasks', ',', ' ', 'dispatch', ']', ' = ', 'useReducer', '(', 'tasksReducer', ',', ' ', 'initialTasks', ')', ';', '\\n', 'To pass them down the tree, you will ', 'create', ' two separate contexts:', '\\n', '\\n', 'TasksContext', ' provides the current list of tasks.', '\\n', 'TasksDispatchContext', ' provides the function that lets components dispatch actions.', '\\n', '\\n', 'Export them from a separate file so that you can later import them from other files:', '\\n', 'App.js', 'TasksContext.js', 'AddTask.js', 'TaskList.js', 'TasksContext.js', ' Reset', 'Fork', 'import', ' ', '{', ' ', 'createContext', ' ', '}', ' ', 'from', ' ', \"'react'\", ';', '\\n\\n', 'export', ' ', 'const', ' ', 'TasksContext', ' = ', 'createContext', '(', 'null', ')', ';', '\\n', 'export', ' ', 'const', ' ', 'TasksDispatchContext', ' = ', 'createContext', '(', 'null', ')', ';', '\\n\\n', '\\n', 'Here, you’re passing ', 'null', ' as the default value to both contexts. The actual values will be provided by the ', 'TaskApp', ' component.', '\\n', 'Step 2: Put state and dispatch into context ', '\\n', 'Now you can import both contexts in your ', 'TaskApp', ' component. Take the ', 'tasks', ' and ', 'dispatch', ' returned by ', 'useReducer()', ' and ', 'provide them', ' to the entire tree below:', '\\n', 'import', ' ', '{', ' ', 'TasksContext', ',', ' ', 'TasksDispatchContext', ' ', '}', ' ', 'from', ' ', \"'./TasksContext.js'\", ';', 'export', ' ', 'default', ' ', 'function', ' ', 'TaskApp', '(', ')', ' ', '{', '  ', 'const', ' ', '[', 'tasks', ',', ' ', 'dispatch', ']', ' = ', 'useReducer', '(', 'tasksReducer', ',', ' ', 'initialTasks', ')', ';', '  ', '// ...', '  ', 'return', ' ', '(', '    ', '<', 'TasksContext', '.', 'Provider', ' ', 'value', '=', '{', 'tasks', '}', '>', '      ', '<', 'TasksDispatchContext', '.', 'Provider', ' ', 'value', '=', '{', 'dispatch', '}', '>', '        ...', '      ', '</', 'TasksDispatchContext', '.', 'Provider', '>', '    ', '</', 'TasksContext', '.', 'Provider', '>', '  ', ')', ';', '}', '\\n', 'For now, you pass the information both via props and in context:', '\\n', 'App.js', 'TasksContext.js', 'AddTask.js', 'TaskList.js', 'App.js', ' Reset', 'Fork', 'import', ' ', '{', ' ', 'useReducer', ' ', '}', ' ', 'from', ' ', \"'react'\", ';', '\\n', 'import', ' ', 'AddTask', ' ', 'from', ' ', \"'./AddTask.js'\", ';', '\\n', 'import', ' ', 'TaskList', ' ', 'from', ' ', \"'./TaskList.js'\", ';', '\\n', 'import', ' ', '{', ' ', 'TasksContext', ',', ' ', 'TasksDispatchContext', ' ', '}', ' ', 'from', ' ', \"'./TasksContext.js'\", ';', '\\n\\n', 'export', ' ', 'default', ' ', 'function', ' ', 'TaskApp', '(', ')', ' ', '{', '\\n  ', 'const', ' ', '[', 'tasks', ',', ' ', 'dispatch', ']', ' = ', 'useReducer', '(', '\\n    ', 'tasksReducer', ',', '\\n    ', 'initialTasks', '\\n  ', ')', ';', '\\n\\n  ', 'function', ' ', 'handleAddTask', '(', 'text', ')', ' ', '{', '\\n    ', 'dispatch', '(', '{', '\\n      ', 'type', ':', ' ', \"'added'\", ',', '\\n      ', 'id', ':', ' ', 'nextId', '++', ',', '\\n      ', 'text', ':', ' ', 'text', ',', '\\n    ', '}', ')', ';', '\\n  ', '}', '\\n\\n  ', 'function', ' ', 'handleChangeTask', '(', 'task', ')', ' ', '{', '\\n    ', 'dispatch', '(', '{', '\\n      ', 'type', ':', ' ', \"'changed'\", ',', '\\n      ', 'task', ':', ' ', 'task', '\\n    ', '}', ')', ';', '\\n  ', '}', '\\n\\n  ', 'function', ' ', 'handleDeleteTask', '(', 'taskId', ')', ' ', '{', '\\n    ', 'dispatch', '(', '{', '\\n      ', 'type', ':', ' ', \"'deleted'\", ',', '\\n      ', 'id', ':', ' ', 'taskId', '\\n    ', '}', ')', ';', '\\n  ', '}', '\\n\\n  ', 'return', ' ', '(', '\\n    ', '<', 'TasksContext', '.', 'Provider', ' ', 'value', '=', '{', 'tasks', '}', '>', '\\n      ', '<', 'TasksDispatchContext', '.', 'Provider', ' ', 'value', '=', '{', 'dispatch', '}', '>', '\\n        ', '<', 'h1', '>', 'Day off in Kyoto', '</', 'h1', '>', '\\n        ', '<', 'AddTask', '\\n          ', 'onAddTask', '=', '{', 'handleAddTask', '}', '\\n        ', '/>', '\\n        ', '<', 'TaskList', '\\n          ', 'tasks', '=', '{', 'tasks', '}', '\\n          ', 'onChangeTask', '=', '{', 'handleChangeTask', '}', '\\n          ', 'onDeleteTask', '=', '{', 'handleDeleteTask', '}', '\\n        ', '/>', '\\n      ', '</', 'TasksDispatchContext', '.', 'Provider', '>', '\\n    ', '</', 'TasksContext', '.', 'Provider', '>', '\\n  ', ')', ';', '\\n', '}', '\\n\\n', 'function', ' ', 'tasksReducer', '(', 'tasks', ',', ' ', 'action', ')', ' ', '{', '\\n  ', 'switch', ' ', '(', 'action', '.', 'type', ')', ' ', '{', '\\n    ', 'case', ' ', \"'added'\", ':', ' ', '{', '\\n      ', 'return', ' ', '[', '...', 'tasks', ',', ' ', '{', '\\n        ', 'id', ':', ' ', 'action', '.', 'id', ',', '\\n        ', 'text', ':', ' ', 'action', '.', 'text', ',', '\\n        ', 'done', ':', ' ', 'false', '\\n      ', '}', ']', ';', '\\n    ', '}', '\\n    ', 'case', ' ', \"'changed'\", ':', ' ', '{', '\\n      ', 'return', ' ', 'tasks', '.', 'map', '(', 't', ' ', '=>', ' ', '{', '\\n        ', 'if', ' ', '(', 't', '.', 'id', ' === ', 'action', '.', 'task', '.', 'id', ')', ' ', '{', '\\n          ', 'return', ' ', 'action', '.', 'task', ';', '\\n        ', '}', ' ', 'else', ' ', '{', '\\n          ', 'return', ' ', 't', ';', '\\n        ', '}', '\\n      ', '}', ')', ';', '\\n    ', '}', '\\n    ', 'case', ' ', \"'deleted'\", ':', ' ', '{', '\\n      ', 'return', ' ', 'tasks', '.', 'filter', '(', 't', ' ', '=>', ' ', 't', '.', 'id', ' !== ', 'action', '.', 'id', ')', ';', '\\n    ', '}', '\\n    ', 'default', ':', ' ', '{', '\\n      ', 'throw', ' ', 'Error', '(', \"'Unknown action: '\", ' + ', 'action', '.', 'type', ')', ';', '\\n    ', '}', '\\n  ', '}', '\\n', '}', '\\n\\n', 'let', ' ', 'nextId', ' = ', '3', ';', '\\n', 'const', ' ', 'initialTasks', ' = ', '[', '\\n  ', '{', ' ', 'id', ':', ' ', '0', ',', ' ', 'text', ':', ' ', \"'Philosopher’s Path'\", ',', ' ', 'done', ':', ' ', 'true', ' ', '}', ',', '\\n  ', '{', ' ', 'id', ':', ' ', '1', ',', ' ', 'text', ':', ' ', \"'Visit the temple'\", ',', ' ', 'done', ':', ' ', 'false', ' ', '}', ',', '\\n  ', '{', ' ', 'id', ':', ' ', '2', ',', ' ', 'text', ':', ' ', \"'Drink matcha'\", ',', ' ', 'done', ':', ' ', 'false', ' ', '}', '\\n', ']', ';', '\\n\\n', 'Show more', '\\n', 'In the next step, you will remove prop passing.', '\\n', 'Step 3: Use context anywhere in the tree ', '\\n', 'Now you don’t need to pass the list of tasks or the event handlers down the tree:', '\\n', '<', 'TasksContext', '.', 'Provider', ' ', 'value', '=', '{', 'tasks', '}', '>', '  ', '<', 'TasksDispatchContext', '.', 'Provider', ' ', 'value', '=', '{', 'dispatch', '}', '>', '    ', '<', 'h1', '>', 'Day off in Kyoto', '</', 'h1', '>', '    ', '<', 'AddTask', ' ', '/>', '    ', '<', 'TaskList', ' ', '/>', '  ', '</', 'TasksDispatchContext', '.', 'Provider', '>', '</', 'TasksContext', '.', 'Provider', '>', '\\n', 'Instead, any component that needs the task list can read it from the ', 'TaskContext', ':', '\\n', 'export', ' ', 'default', ' ', 'function', ' ', 'TaskList', '(', ')', ' ', '{', '  ', 'const', ' ', 'tasks', ' = ', 'useContext', '(', 'TasksContext', ')', ';', '  ', '// ...', '\\n', 'To update the task list, any component can read the ', 'dispatch', ' function from context and call it:', '\\n', 'export', ' ', 'default', ' ', 'function', ' ', 'AddTask', '(', ')', ' ', '{', '  ', 'const', ' ', '[', 'text', ',', ' ', 'setText', ']', ' = ', 'useState', '(', \"''\", ')', ';', '  ', 'const', ' ', 'dispatch', ' = ', 'useContext', '(', 'TasksDispatchContext', ')', ';', '  ', '// ...', '  ', 'return', ' ', '(', '    ', '// ...', '    ', '<', 'button', ' ', 'onClick', '=', '{', '(', ')', ' ', '=>', ' ', '{', '      ', 'setText', '(', \"''\", ')', ';', '      ', 'dispatch', '(', '{', '        ', 'type', ':', ' ', \"'added'\", ',', '        ', 'id', ':', ' ', 'nextId', '++', ',', '        ', 'text', ':', ' ', 'text', ',', '      ', '}', ')', ';', '    ', '}', '}', '>', 'Add', '</', 'button', '>', '    ', '// ...', '\\n', 'The ', 'TaskApp', ' component does not pass any event handlers down, and the ', 'TaskList', ' does not pass any event handlers to the ', 'Task', ' component either.', ' Each component reads the context that it needs:', '\\n', 'App.js', 'TasksContext.js', 'AddTask.js', 'TaskList.js', 'TaskList.js', ' Reset', 'Fork', 'import', ' ', '{', ' ', 'useState', ',', ' ', 'useContext', ' ', '}', ' ', 'from', ' ', \"'react'\", ';', '\\n', 'import', ' ', '{', ' ', 'TasksContext', ',', ' ', 'TasksDispatchContext', ' ', '}', ' ', 'from', ' ', \"'./TasksContext.js'\", ';', '\\n\\n', 'export', ' ', 'default', ' ', 'function', ' ', 'TaskList', '(', ')', ' ', '{', '\\n  ', 'const', ' ', 'tasks', ' = ', 'useContext', '(', 'TasksContext', ')', ';', '\\n  ', 'return', ' ', '(', '\\n    ', '<', 'ul', '>', '\\n      ', '{', 'tasks', '.', 'map', '(', 'task', ' ', '=>', ' ', '(', '\\n        ', '<', 'li', ' ', 'key', '=', '{', 'task', '.', 'id', '}', '>', '\\n          ', '<', 'Task', ' ', 'task', '=', '{', 'task', '}', ' ', '/>', '\\n        ', '</', 'li', '>', '\\n      ', ')', ')', '}', '\\n    ', '</', 'ul', '>', '\\n  ', ')', ';', '\\n', '}', '\\n\\n', 'function', ' ', 'Task', '(', '{', ' ', 'task', ' ', '}', ')', ' ', '{', '\\n  ', 'const', ' ', '[', 'isEditing', ',', ' ', 'setIsEditing', ']', ' = ', 'useState', '(', 'false', ')', ';', '\\n  ', 'const', ' ', 'dispatch', ' = ', 'useContext', '(', 'TasksDispatchContext', ')', ';', '\\n  ', 'let', ' ', 'taskContent', ';', '\\n  ', 'if', ' ', '(', 'isEditing', ')', ' ', '{', '\\n    ', 'taskContent', ' = ', '(', '\\n      ', '<', '>', '\\n        ', '<', 'input', '\\n          ', 'value', '=', '{', 'task', '.', 'text', '}', '\\n          ', 'onChange', '=', '{', 'e', ' ', '=>', ' ', '{', '\\n            ', 'dispatch', '(', '{', '\\n              ', 'type', ':', ' ', \"'changed'\", ',', '\\n              ', 'task', ':', ' ', '{', '\\n                ', '...', 'task', ',', '\\n                ', 'text', ':', ' ', 'e', '.', 'target', '.', 'value', '\\n              ', '}', '\\n            ', '}', ')', ';', '\\n          ', '}', '}', ' ', '/>', '\\n        ', '<', 'button', ' ', 'onClick', '=', '{', '(', ')', ' ', '=>', ' ', 'setIsEditing', '(', 'false', ')', '}', '>', '\\n          Save\\n        ', '</', 'button', '>', '\\n      ', '</', '>', '\\n    ', ')', ';', '\\n  ', '}', ' ', 'else', ' ', '{', '\\n    ', 'taskContent', ' = ', '(', '\\n      ', '<', '>', '\\n        ', '{', 'task', '.', 'text', '}', '\\n        ', '<', 'button', ' ', 'onClick', '=', '{', '(', ')', ' ', '=>', ' ', 'setIsEditing', '(', 'true', ')', '}', '>', '\\n          Edit\\n        ', '</', 'button', '>', '\\n      ', '</', '>', '\\n    ', ')', ';', '\\n  ', '}', '\\n  ', 'return', ' ', '(', '\\n    ', '<', 'label', '>', '\\n      ', '<', 'input', '\\n        ', 'type', '=', '\"checkbox\"', '\\n        ', 'checked', '=', '{', 'task', '.', 'done', '}', '\\n        ', 'onChange', '=', '{', 'e', ' ', '=>', ' ', '{', '\\n          ', 'dispatch', '(', '{', '\\n            ', 'type', ':', ' ', \"'changed'\", ',', '\\n            ', 'task', ':', ' ', '{', '\\n              ', '...', 'task', ',', '\\n              ', 'done', ':', ' ', 'e', '.', 'target', '.', 'checked', '\\n            ', '}', '\\n          ', '}', ')', ';', '\\n        ', '}', '}', '\\n      ', '/>', '\\n      ', '{', 'taskContent', '}', '\\n      ', '<', 'button', ' ', 'onClick', '=', '{', '(', ')', ' ', '=>', ' ', '{', '\\n        ', 'dispatch', '(', '{', '\\n          ', 'type', ':', ' ', \"'deleted'\", ',', '\\n          ', 'id', ':', ' ', 'task', '.', 'id', '\\n        ', '}', ')', ';', '\\n      ', '}', '}', '>', '\\n        Delete\\n      ', '</', 'button', '>', '\\n    ', '</', 'label', '>', '\\n  ', ')', ';', '\\n', '}', '\\n\\n', 'Show more', '\\n', 'The state still “lives” in the top-level ', 'TaskApp', ' component, managed with ', 'useReducer', '.', ' But its ', 'tasks', ' and ', 'dispatch', ' are now available to every component below in the tree by importing and using these contexts.', '\\n', 'Moving all wiring into a single file ', '\\n', 'You don’t have to do this, but you could further declutter the components by moving both reducer and context into a single file. Currently, ', 'TasksContext.js', ' contains only two context declarations:', '\\n', 'import', ' ', '{', ' ', 'createContext', ' ', '}', ' ', 'from', ' ', \"'react'\", ';', 'export', ' ', 'const', ' ', 'TasksContext', ' = ', 'createContext', '(', 'null', ')', ';', 'export', ' ', 'const', ' ', 'TasksDispatchContext', ' = ', 'createContext', '(', 'null', ')', ';', '\\n', 'This file is about to get crowded! You’ll move the reducer into that same file. Then you’ll declare a new ', 'TasksProvider', ' component in the same file. This component will tie all the pieces together:', '\\n', '\\n', 'It will manage the state with a reducer.', '\\n', 'It will provide both contexts to components below.', '\\n', 'It will ', 'take ', 'children', ' as a prop', ' so you can pass JSX to it.', '\\n', '\\n', 'export', ' ', 'function', ' ', 'TasksProvider', '(', '{', ' ', 'children', ' ', '}', ')', ' ', '{', '  ', 'const', ' ', '[', 'tasks', ',', ' ', 'dispatch', ']', ' = ', 'useReducer', '(', 'tasksReducer', ',', ' ', 'initialTasks', ')', ';', '  ', 'return', ' ', '(', '    ', '<', 'TasksContext', '.', 'Provider', ' ', 'value', '=', '{', 'tasks', '}', '>', '      ', '<', 'TasksDispatchContext', '.', 'Provider', ' ', 'value', '=', '{', 'dispatch', '}', '>', '        ', '{', 'children', '}', '      ', '</', 'TasksDispatchContext', '.', 'Provider', '>', '    ', '</', 'TasksContext', '.', 'Provider', '>', '  ', ')', ';', '}', '\\n', 'This removes all the complexity and wiring from your ', 'TaskApp', ' component:', '\\n', 'App.js', 'TasksContext.js', 'AddTask.js', 'TaskList.js', 'App.js', ' Reset', 'Fork', 'import', ' ', 'AddTask', ' ', 'from', ' ', \"'./AddTask.js'\", ';', '\\n', 'import', ' ', 'TaskList', ' ', 'from', ' ', \"'./TaskList.js'\", ';', '\\n', 'import', ' ', '{', ' ', 'TasksProvider', ' ', '}', ' ', 'from', ' ', \"'./TasksContext.js'\", ';', '\\n\\n', 'export', ' ', 'default', ' ', 'function', ' ', 'TaskApp', '(', ')', ' ', '{', '\\n  ', 'return', ' ', '(', '\\n    ', '<', 'TasksProvider', '>', '\\n      ', '<', 'h1', '>', 'Day off in Kyoto', '</', 'h1', '>', '\\n      ', '<', 'AddTask', ' ', '/>', '\\n      ', '<', 'TaskList', ' ', '/>', '\\n    ', '</', 'TasksProvider', '>', '\\n  ', ')', ';', '\\n', '}', '\\n\\n', '\\n', 'You can also export functions that ', 'use', ' the context from ', 'TasksContext.js', ':', '\\n', 'export', ' ', 'function', ' ', 'useTasks', '(', ')', ' ', '{', '  ', 'return', ' ', 'useContext', '(', 'TasksContext', ')', ';', '}', 'export', ' ', 'function', ' ', 'useTasksDispatch', '(', ')', ' ', '{', '  ', 'return', ' ', 'useContext', '(', 'TasksDispatchContext', ')', ';', '}', '\\n', 'When a component needs to read context, it can do it through these functions:', '\\n', 'const', ' ', 'tasks', ' = ', 'useTasks', '(', ')', ';', 'const', ' ', 'dispatch', ' = ', 'useTasksDispatch', '(', ')', ';', '\\n', 'This doesn’t change the behavior in any way, but it lets you later split these contexts further or add some logic to these functions. ', 'Now all of the context and reducer wiring is in ', 'TasksContext.js', '. This keeps the components clean and uncluttered, focused on what they display rather than where they get the data:', '\\n', 'App.js', 'TasksContext.js', 'AddTask.js', 'TaskList.js', 'TaskList.js', ' Reset', 'Fork', 'import', ' ', '{', ' ', 'useState', ' ', '}', ' ', 'from', ' ', \"'react'\", ';', '\\n', 'import', ' ', '{', ' ', 'useTasks', ',', ' ', 'useTasksDispatch', ' ', '}', ' ', 'from', ' ', \"'./TasksContext.js'\", ';', '\\n\\n', 'export', ' ', 'default', ' ', 'function', ' ', 'TaskList', '(', ')', ' ', '{', '\\n  ', 'const', ' ', 'tasks', ' = ', 'useTasks', '(', ')', ';', '\\n  ', 'return', ' ', '(', '\\n    ', '<', 'ul', '>', '\\n      ', '{', 'tasks', '.', 'map', '(', 'task', ' ', '=>', ' ', '(', '\\n        ', '<', 'li', ' ', 'key', '=', '{', 'task', '.', 'id', '}', '>', '\\n          ', '<', 'Task', ' ', 'task', '=', '{', 'task', '}', ' ', '/>', '\\n        ', '</', 'li', '>', '\\n      ', ')', ')', '}', '\\n    ', '</', 'ul', '>', '\\n  ', ')', ';', '\\n', '}', '\\n\\n', 'function', ' ', 'Task', '(', '{', ' ', 'task', ' ', '}', ')', ' ', '{', '\\n  ', 'const', ' ', '[', 'isEditing', ',', ' ', 'setIsEditing', ']', ' = ', 'useState', '(', 'false', ')', ';', '\\n  ', 'const', ' ', 'dispatch', ' = ', 'useTasksDispatch', '(', ')', ';', '\\n  ', 'let', ' ', 'taskContent', ';', '\\n  ', 'if', ' ', '(', 'isEditing', ')', ' ', '{', '\\n    ', 'taskContent', ' = ', '(', '\\n      ', '<', '>', '\\n        ', '<', 'input', '\\n          ', 'value', '=', '{', 'task', '.', 'text', '}', '\\n          ', 'onChange', '=', '{', 'e', ' ', '=>', ' ', '{', '\\n            ', 'dispatch', '(', '{', '\\n              ', 'type', ':', ' ', \"'changed'\", ',', '\\n              ', 'task', ':', ' ', '{', '\\n                ', '...', 'task', ',', '\\n                ', 'text', ':', ' ', 'e', '.', 'target', '.', 'value', '\\n              ', '}', '\\n            ', '}', ')', ';', '\\n          ', '}', '}', ' ', '/>', '\\n        ', '<', 'button', ' ', 'onClick', '=', '{', '(', ')', ' ', '=>', ' ', 'setIsEditing', '(', 'false', ')', '}', '>', '\\n          Save\\n        ', '</', 'button', '>', '\\n      ', '</', '>', '\\n    ', ')', ';', '\\n  ', '}', ' ', 'else', ' ', '{', '\\n    ', 'taskContent', ' = ', '(', '\\n      ', '<', '>', '\\n        ', '{', 'task', '.', 'text', '}', '\\n        ', '<', 'button', ' ', 'onClick', '=', '{', '(', ')', ' ', '=>', ' ', 'setIsEditing', '(', 'true', ')', '}', '>', '\\n          Edit\\n        ', '</', 'button', '>', '\\n      ', '</', '>', '\\n    ', ')', ';', '\\n  ', '}', '\\n  ', 'return', ' ', '(', '\\n    ', '<', 'label', '>', '\\n      ', '<', 'input', '\\n        ', 'type', '=', '\"checkbox\"', '\\n        ', 'checked', '=', '{', 'task', '.', 'done', '}', '\\n        ', 'onChange', '=', '{', 'e', ' ', '=>', ' ', '{', '\\n          ', 'dispatch', '(', '{', '\\n            ', 'type', ':', ' ', \"'changed'\", ',', '\\n            ', 'task', ':', ' ', '{', '\\n              ', '...', 'task', ',', '\\n              ', 'done', ':', ' ', 'e', '.', 'target', '.', 'checked', '\\n            ', '}', '\\n          ', '}', ')', ';', '\\n        ', '}', '}', '\\n      ', '/>', '\\n      ', '{', 'taskContent', '}', '\\n      ', '<', 'button', ' ', 'onClick', '=', '{', '(', ')', ' ', '=>', ' ', '{', '\\n        ', 'dispatch', '(', '{', '\\n          ', 'type', ':', ' ', \"'deleted'\", ',', '\\n          ', 'id', ':', ' ', 'task', '.', 'id', '\\n        ', '}', ')', ';', '\\n      ', '}', '}', '>', '\\n        Delete\\n      ', '</', 'button', '>', '\\n    ', '</', 'label', '>', '\\n  ', ')', ';', '\\n', '}', '\\n\\n', 'Show more', '\\n', 'You can think of ', 'TasksProvider', ' as a part of the screen that knows how to deal with tasks, ', 'useTasks', ' as a way to read them, and ', 'useTasksDispatch', ' as a way to update them from any component below in the tree.', '\\n', 'Note', 'Functions like ', 'useTasks', ' and ', 'useTasksDispatch', ' are called ', 'Custom Hooks.', ' Your function is considered a custom Hook if its name starts with ', 'use', '. This lets you use other Hooks, like ', 'useContext', ', inside it.', '\\n', 'As your app grows, you may have many context-reducer pairs like this. This is a powerful way to scale your app and ', 'lift state up', ' without too much work whenever you want to access the data deep in the tree.', '\\n', 'Recap', '\\n', 'You can combine reducer with context to let any component read and update state above it.', '\\n', 'To provide state and the dispatch function to components below:', '\\n', '\\n', 'Create two contexts (for state and for dispatch functions).', '\\n', 'Provide both contexts from the component that uses the reducer.', '\\n', 'Use either context from components that need to read them.', '\\n', '\\n', '\\n', 'You can further declutter the components by moving all wiring into one file.', '\\n', '\\n', 'You can export a component like ', 'TasksProvider', ' that provides context.', '\\n', 'You can also export custom Hooks like ', 'useTasks', ' and ', 'useTasksDispatch', ' to read it.', '\\n', '\\n', '\\n', 'You can have many context-reducer pairs like this in your app.', '\\n', 'Previous', 'Passing Data Deeply with Context', 'Next', 'Escape Hatches', 'How do you like these docs?', 'Take our survey!', '©', '2024', 'Learn React', 'Quick Start', 'Installation', 'Describing the UI', 'Adding Interactivity', 'Managing State', 'Escape Hatches', 'API Reference', 'React APIs', 'React DOM APIs', 'Community', 'Code of Conduct', 'Meet the Team', 'Docs Contributors', 'Acknowledgements', 'More', 'Blog', 'React Native', 'Privacy', 'Terms', 'On this page', 'Overview', 'Combining a reducer with context ', 'Step 1: Create the context ', 'Step 2: Put state and dispatch into context ', 'Step 3: Use context anywhere in the tree ', 'Moving all wiring into a single file ', 'Recap', "}